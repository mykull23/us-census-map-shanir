<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ACS Data Visualization</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
    
    <!-- D3.js for color scales -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
    
    <!-- Our CSS -->
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/map.css">
    <link rel="stylesheet" href="css/notifications.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <h1>üìä ACS Data Visualization</h1>
            <div class="header-controls">
                <div class="api-status">
                    <span class="status-indicator" id="statusIndicator"></span>
                    <span id="apiStatusText">Loading...</span>
                </div>
                <button id="clearCacheBtn" class="btn btn-secondary">Clear Cache</button>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar">
                <div class="control-panel">
                    <h3>üîç Search Controls</h3>
                    
                    <div class="form-group">
                        <label for="searchType">Search Type</label>
                        <select id="searchType" class="form-control">
                            <option value="zip">ZIP Code</option>
                            <option value="radius">Radius Search</option>
                            <option value="state">State</option>
                            <option value="city">City</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="searchInput">Enter Search</label>
                        <div class="input-group">
                            <input type="text" id="searchInput" class="form-control" placeholder="e.g., 10001 or New York">
                            <button id="searchBtn" class="btn btn-primary">Search</button>
                        </div>
                    </div>

                    <div class="form-group radius-controls" id="radiusControls" style="display: none;">
                        <label for="radiusInput">Radius (miles)</label>
                        <input type="range" id="radiusInput" min="1" max="100" value="10" class="form-control">
                        <span id="radiusValue">10 miles</span>
                    </div>

                    <div class="form-group">
                        <label for="variableSelect">ACS Variable</label>
                        <select id="variableSelect" class="form-control">
                            <option value="B01003_001E">Total Population</option>
                            <option value="B19013_001E">Median Household Income</option>
                            <option value="B25077_001E">Median Home Value</option>
                            <option value="B25001_001E">Housing Units</option>
                            <option value="B08301_001E">Means of Transportation</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="resultsLimit">Max Results</label>
                        <input type="number" id="resultsLimit" min="1" max="1000" value="100" class="form-control">
                    </div>

                    <div class="button-group">
                        <button id="exportDataBtn" class="btn btn-secondary">Export Data</button>
                        <button id="clearMapBtn" class="btn btn-danger">Clear Map</button>
                    </div>
                </div>

                <div class="stats-panel">
                    <h3>üìà Statistics</h3>
                    <div id="statsContent">
                        <div class="stat-item">
                            <span class="stat-label">ZIP Codes Loaded:</span>
                            <span id="zipCount" class="stat-value">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">API Requests:</span>
                            <span id="apiRequests" class="stat-value">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Cache Hits:</span>
                            <span id="cacheHits" class="stat-value">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Data Points:</span>
                            <span id="dataPoints" class="stat-value">0</span>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Main Map Area -->
            <main class="map-area">
                <div id="mapContainer" class="map-container"></div>
                
                <!-- Map Controls -->
                <div class="map-controls">
                    <button id="zoomInBtn" class="map-control-btn">+</button>
                    <button id="zoomOutBtn" class="map-control-btn">-</button>
                    <button id="fitBoundsBtn" class="map-control-btn">üìç</button>
                </div>

                <!-- Results Info -->
                <div id="resultsPanel" class="results-panel">
                    <h4>Results</h4>
                    <div id="resultsContent"></div>
                </div>
            </main>
        </div>

        <!-- Footer -->
        <footer class="app-footer">
            <div class="footer-info">
                <span>ACS Data Source: U.S. Census Bureau</span>
                <span>Cache: <span id="cacheStatus">Not loaded</span></span>
                <span>Last Updated: <span id="lastUpdated">-</span></span>
            </div>
        </footer>
    </div>

    <!-- JavaScript Files -->
    <script src="js/zipCodeIndex.js"></script>
    <script src="js/acsApiService.js"></script>
    <script src="js/mapVisualizer.js"></script>
    <script src="js/notificationSystem.js"></script>
    <script src="js/application.js"></script>
    <script src="js/main.js"></script>
</body>
</html>